<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E-commerce Chatbot</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    h2 { color: #333; }
    input, button { padding: 10px; margin: 5px; width: 300px; }
    #result { margin-top: 20px; background: white; padding: 10px; border: 1px solid #ccc; }
  </style>
</head>
<body>

<h2>Customer Support Chatbot</h2>

<input type="text" id="question" placeholder="Ask a question..." />
<button onclick="ask()">Ask</button>

<div id="result"></div>

<script>
  async function ask() {
    const question = document.getElementById('question').value.toLowerCase();
    const resultBox = document.getElementById('result');
    resultBox.innerHTML = '⏳ Loading...';

    try {
      if (question.includes('top 5') || question.includes('top five')) {
        const res = await fetch('http://localhost:3000/top-products');
        const data = await res.json();
        resultBox.innerHTML = `<b>Top 5 Products:</b><br>` + data.map(p => `Product ID: ${p.product_id}, Sold: ${p.quantity}`).join('<br>');
      } else if (question.includes('order id')) {
        const orderId = question.match(/\d+/)[0];
        const res = await fetch(`http://localhost:3000/order-status/${orderId}`);
        const data = await res.json();
        resultBox.innerHTML = `<b>Order Status:</b> ${data.status || data.error}`;
      } else if (question.includes('how many') || question.includes('stock')) {
        const product = question.split('how many ')[1].split(' ')[0];
        const res = await fetch(`http://localhost:3000/stock/${product}`);
        const data = await res.json();
        resultBox.innerHTML = `<b>Stock Info:</b> ${data.stock ? `${data.name} - ${data.stock} left` : data.error}`;
      } else {
        resultBox.innerHTML = '❌ I do not understand the question.';
      }
    } catch (err) {
      resultBox.innerHTML = '❌ Error: ' + err.message;
    }
  }
</script>

</body>
</html>
